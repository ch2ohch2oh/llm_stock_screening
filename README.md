# AI-Powered Stock Analysis Report Generator

(This README is generated by AI as well)

This project automates the generation of detailed financial analysis reports for a given list of stock tickers. It leverages Google's Gemini API to produce qualitative analysis, including company summaries, investment pros, and cons. The final output is a professional, multi-page PDF report that combines this analysis with quantitative data visualizations.

## Features

- **Automated PDF Generation**: Creates multi-page PDF reports from stock scoring data.
- **AI-Powered Insights**: Integrates with the Google Gemini API for dynamic, in-depth company analysis.
- **Efficient Caching**: Caches LLM responses to minimize API calls, reduce costs, and speed up subsequent runs.
- **Data Visualization**: Seamlessly embeds charts and plots for each stock directly into the report.
- **Customizable Reports**: Use command-line arguments to tailor reports, such as limiting the analysis to the top N stocks.
- **Professional Formatting**: Includes a dynamically generated cover page, page numbers, and unique, timestamped filenames.

## Requirements

- Python 3.7+
- Google Gemini API Key

## Setup & Installation

1.  **Clone the repository:**
    ```sh
    git clone <your-repository-url>
    ```

2.  **Install the required Python packages:**
    It's recommended to use a virtual environment.
    ```sh
    # Create and activate a virtual environment (optional but recommended)
    python -m venv .venv
    source .venv/bin/activate  # On Windows use `.venv\Scripts\activate`

    # Install dependencies
    pip install -r requirements.txt
    ```

3.  **Set up your Google API Key:**
    You need to set your Google Gemini API key as an environment variable named `GOOGLE_API_KEY`.

    -   **Windows (Command Prompt):**
        ```cmd
        set GOOGLE_API_KEY="YOUR_API_KEY"
        ```
    -   **Windows (PowerShell):**
        ```powershell
        $env:GOOGLE_API_KEY="YOUR_API_KEY"
        ```
    -   **Linux / macOS:**
        ```sh
        export GOOGLE_API_KEY="YOUR_API_KEY"
        ```
    *Note: Replace `"YOUR_API_KEY"` with your actual key. To make the key permanent, add this line to your shell's startup file (e.g., `.bashrc`, `.zshrc`, or set it in your system's environment variables GUI).*

## Usage

The primary script for generating reports is `generate_report.py`.

### Input Data

The script requires an input JSON file (default: `scoring_results.json`) which should be an array of objects, where each object represents a stock. The project must be run from a context where the `figure` paths in the JSON are valid.

**Example `scoring_results.json` entry:**
```json
[
    {
        "ranking": 1,
        "ticker": "HWM",
        "score": 0.20905752989179882,
        "figure": "C:\\Users\\Dazhi Wang\\strat\\plots\\HWM.png"
    }
]
```

### Running the Script

1.  **Generate a standard report:**
    This command uses the default settings, reading from `scoring_results.json` and saving to the `reports/` directory.
    ```sh
    python generate_report.py
    ```

2.  **Generate a report for the top 10 stocks:**
    The `--top` argument limits the report to the first 10 entries in the JSON file.
    ```sh
    python generate_report.py --top 10
    ```

### Command-Line Arguments

- `--input-json`: Path to the input JSON file (default: `scoring_results.json`).
- `--output-dir`: Directory to save the generated PDF report (default: `reports`).
- `--filename`: Base name for the output PDF. A timestamp will be appended automatically (default: `Combined_Stock_Report.pdf`).
- `--top <N>`: An integer to limit the report to the top N tickers from the input file.
- `--cache-file`: Path to the file used for caching LLM responses (default: `.gemini_cache.json`).